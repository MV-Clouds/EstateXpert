<template>
    <template if:true={showSpinner}>
        <c-spinner-component></c-spinner-component>
    </template>

    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_small">
        <div class="slds-modal__container">
            <div class="slds-modal__close closs_icon_css" onclick={handleDialogueClose}>
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M2.53317 19.3333L0.666504 17.4667L8.13317 9.99999L0.666504 2.53332L2.53317 0.666656L9.99984 8.13332L17.4665 0.666656L19.3332 2.53332L11.8665 9.99999L19.3332 17.4667L17.4665 19.3333L9.99984 11.8667L2.53317 19.3333Z"
                        fill="white" />
                </svg>
            </div>

            <div class="slds-modal__header blue-header">
                <h1 id="modal-heading-01" class="slds-modal__title slds-hyphenate" tabindex="-1">Upload File</h1>
            </div>
            <div class="slds-modal__content slds-p-around_medium slds-p-bottom_small modalbody" id="modal-content-id-1">
                <div class="content_body">
                    <div class="tab-container">
                        <div class="tab-menu">
                            <ul>
                                <li onclick={tabing} data-name="AWS"><a class="active-tab" data-tab-id="tab1">AWS File
                                        Uploader</a></li>
                                <li onclick={tabing} data-name="Datalink"><a data-tab-id="tab2">Add Link</a></li>
                            </ul>
                        </div>

                        <div class="tab active-tab-content" data-id="tab1">
                            <div class="fileuploader_container">
                                <div class="slds-file-selector slds-file-selector_images" ondrop={handleDrop}
                                    ondragover={allowDrop}>
                                    <div class="slds-file-selector__dropzone flex_css">
                                        <div>
                                            <svg width="36" height="28" viewBox="0 0 36 28" fill="none"
                                                xmlns="http://www.w3.org/2000/svg">
                                                <path
                                                    d="M3.232 28C2.31067 28 1.542 27.692 0.926 27.076C0.31 26.46 0.00133333 25.6907 0 24.768V3.232C0 2.31067 0.308667 1.542 0.926 0.926C1.54333 0.31 2.31133 0.00133333 3.23 0H11.85C12.2807 0 12.6993 0.0866669 13.106 0.26C13.5127 0.436 13.8607 0.668667 14.15 0.958L17.192 4H32.77C33.69 4 34.4587 4.30867 35.076 4.926C35.6933 5.54333 36.0013 6.312 36 7.232V24.77C36 25.69 35.692 26.4587 35.076 27.076C34.46 27.6933 33.6913 28.0013 32.77 28H3.232ZM18 22.46C18.2853 22.46 18.5233 22.3653 18.714 22.176C18.9047 21.9867 19 21.7487 19 21.462V13.062L22.532 16.592C22.7187 16.7787 22.9473 16.8787 23.218 16.892C23.4887 16.9053 23.7313 16.8053 23.946 16.592C24.1607 16.3787 24.2673 16.1427 24.266 15.884C24.2647 15.6253 24.158 15.39 23.946 15.178L19.13 10.362C18.8073 10.0393 18.4307 9.878 18 9.878C17.5693 9.878 17.192 10.0393 16.868 10.362L12.132 15.1C11.944 15.2867 11.844 15.516 11.832 15.788C11.82 16.06 11.92 16.3027 12.132 16.516C12.344 16.7293 12.5793 16.836 12.838 16.836C13.0967 16.836 13.3327 16.7293 13.546 16.516L17 13.06V21.46C17 21.744 17.0953 21.982 17.286 22.174C17.4767 22.366 17.7147 22.4613 18 22.46Z"
                                                    fill="#0276D3" />
                                            </svg>
                                        </div>
                                        <div class="formbold-drop-file images_upcss">
                                            <p>Choose a file or drag & drop it here</p>
                                            <p>OR</p>
                                            <input type="file" class="slds-file-selector__input slds-assistive-text"
                                                onchange={handleSelectedFiles}
                                                accept="image/png, image/jpeg, image/jpg, video/mp4"
                                                id="file-upload-input-107" multiple
                                                aria-labelledby="file-selector-primary-label-105 file-selector-secondary-label106" />
                                            <label class="slds-file-selector__body" for="file-upload-input-107"
                                                id="file-selector-secondary-label106">
                                                <span class="formbold-browse">Browse File</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="watermark_container">
                                <input type="checkbox" onchange={watermarkValue} checked={isWatermark} disabled={checkboxDisabled}/> Upload image
                                with watermark
                            </div>
                            <div class="file_view_upload">
                                <template if:true={isImageData}>
                                    <div class="lightningPillCss">
                                        <template for:each={imageToShowFiles} for:item="imagedata" >
                                            <div class="container" key={imagedata.name}>
                                                <div class="img_css">
                                                    <img src={imagedata.preview} alt="Image" class="image-preview" draggable="false" />
                                                </div>
                                                <div class="box1">
                                                    <p class="imgd1">{imagedata.name}</p>
                                                    <p class="imgd2">{imagedata.size} kb</p>
                                                </div>
                                                <div class="removeImage">
                                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" data-name={imagedata.name} onclick={handleRemove}>
                                                        <path opacity="0.3" d="M12 4C7.59 4 4 7.59 4 12C4 16.41 7.59 20 12 20C16.41 20 20 16.41 20 12C20 7.59 16.41 4 12 4ZM16 14.59L14.59 16L12 13.41L9.41 16L8 14.59L10.59 12L8 9.41L9.41 8L12 10.59L14.59 8L16 9.41L13.41 12L16 14.59Z" fill="#858585"/>
                                                        <path d="M14.59 8L12 10.59L9.41 8L8 9.41L10.59 12L8 14.59L9.41 16L12 13.41L14.59 16L16 14.59L13.41 12L16 9.41L14.59 8ZM12 2C6.47 2 2 6.47 2 12C2 17.53 6.47 22 12 22C17.53 22 22 17.53 22 12C22 6.47 17.53 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20Z" fill="#858585"/>
                                                    </svg>                                                
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </template>
                                <template if:true={isFileUploading}>
                                    <div class="slds-p-around_medium lgc-bg progress slds-box">
                                        <progress value={uploadProgress} max="100"></progress>
                                        <div class="upload_icon_css">
                                            <p><lightning-icon icon-name="utility:upload"
                                                    size="x-small"></lightning-icon>Uploading</p>
                                            <p>{uploadProgress}%</p>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div class="tab" data-id="tab2">
                            <label for="title" class="slds-m-bottom_small label_css"><abbr title="required"
                                    class="slds-required">*</abbr>Title</label>
                            <lightning-input onchange={storeUrl} label="Title" variant="label-hidden"
                                required></lightning-input>
                            <br />
                            <label for="link" class="slds-m-bottom_small label_css"><abbr title="required"
                                    class="slds-required">*</abbr>External Link(URL)</label>
                            <lightning-input variant="label-hidden" label="External Link (URL)" onchange={storeUrl}
                                required></lightning-input>
                            <br />
                            <label for="type" class="slds-m-bottom_small label_css" style="margin-bottom: 4px;"><abbr
                                    title="required" class="slds-required">*</abbr>Type</label>
                            <lightning-combobox name="Type" variant="label-hidden" value={selectedUrlType}
                                options={options} onchange={handleLinkType} required></lightning-combobox>
                        </div>
                    </div>
                </div>
                <div class="footerbtns">
                    <button class="cancel_btn_css" aria-label="Cancel and close"
                        onclick={handleDialogueClose}>Close</button>
                    <button class="save_btn_css" onclick={handleOnSave} disabled={uploadStatus}>Upload</button>
                </div>
            </div>
        </div>
    </section>
    <div class="slds-backdrop slds-backdrop_open" role="presentation"></div>
</template>