<!--
  description       : Display inquiry component to display all the properties
  author            : Rachit Shah
  last modified on  : 06-19-2024
-->
<template>

    <template if:true={isLoading}>
        <c-spinner-component></c-spinner-component>
    </template>

    <div class="main-card">

        <div class="filter-search-container">
            <div class="filter-section">
                <div class="search-bar">
                    <lightning-input variant="label-hidden" type="search" placeholder="Search Inquiry Name"
                        value={searchTerm} onchange={handleSearch} class="search-bar-input"></lightning-input>
                </div>

                <div class="open-mapping-div" onclick={handleInsideClick}>

                    <div class="btn-container">

                        <button class="btn mapping-btn" onclick={openConfigureSettings}>Configure Settings
                        </button>
                        <template if:true={isConfigOpen}>
                            <c-record-config-body-cmp feature-name="Inquiry Manager"
                                onclose={handleCloseModal}></c-record-config-body-cmp>
                        </template>

                        <template if:true={hasBusinessAccountConfigured}>
                            <button class="btn mapping-btn" onclick={handleSendMessage}
                                disabled={isSendEmailButtonDisabled}>Send Message
                            </button>
                        </template>

                        <button class="btn mapping-btn" onclick={openModal} disabled={isSendEmailButtonDisabled}> Send
                            Mail
                        </button>

                        <template if:true={hideFilterButton}>
                            <button class="btn mapping-btn" onclick={showModalBox}>
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M19.8871 9.72997L16.5543 6.31235C16.4703 6.23162 16.3595 6.18669 16.2444 6.18669C16.1292 6.18669 16.0184 6.23162 15.9344 6.31235L15.3145 6.95145C15.2343 7.0368 15.1894 7.15073 15.1894 7.26929C15.1894 7.38784 15.2343 7.50177 15.3145 7.58712L16.331 8.62608C16.3573 8.65639 16.3773 8.69178 16.3901 8.73016C16.4028 8.76854 16.4079 8.80914 16.4051 8.84958C16.4023 8.89001 16.3917 8.92947 16.3738 8.96563C16.3559 9.00178 16.3312 9.03391 16.301 9.06012C16.2521 9.10495 16.1898 9.13145 16.1244 9.13531H6.99913L12.4416 3.58167C12.4712 3.55475 12.5057 3.53416 12.5431 3.52111C12.5805 3.50806 12.6201 3.50281 12.6596 3.50568C12.699 3.50854 12.7375 3.51946 12.7727 3.53779C12.808 3.55613 12.8393 3.5815 12.8649 3.61243C12.9086 3.66257 12.9344 3.72642 12.9382 3.79356V5.31782C12.9327 5.4237 12.9681 5.52753 13.0367 5.60684C13.1053 5.68615 13.2016 5.73457 13.3048 5.74161H14.208C14.3109 5.74817 14.4122 5.71266 14.4896 5.64284C14.5671 5.57303 14.6144 5.4746 14.6213 5.36909V0.423785C14.6244 0.371254 14.6174 0.3186 14.6007 0.268844C14.584 0.219088 14.5578 0.173208 14.5238 0.133836C14.4897 0.094464 14.4484 0.0623742 14.4022 0.0394075C14.356 0.0164408 14.3059 0.00304921 14.2547 0H9.50873C9.39501 0.0103231 9.28926 0.0642787 9.21265 0.151082C9.13603 0.237886 9.09418 0.351142 9.09547 0.468214V1.3192C9.09277 1.37218 9.1003 1.42518 9.11761 1.47517C9.13492 1.52515 9.16168 1.57115 9.19635 1.61052C9.23103 1.64988 9.27294 1.68185 9.31968 1.70458C9.36642 1.72731 9.41707 1.74036 9.46874 1.74299H10.9985C11.037 1.74388 11.075 1.75254 11.1102 1.76848C11.1455 1.78442 11.1773 1.80732 11.204 1.83589C11.2306 1.86445 11.2514 1.89811 11.2654 1.93495C11.2793 1.97179 11.286 2.01108 11.2851 2.05057C11.2828 2.12442 11.2544 2.19488 11.2051 2.2488L4.50618 9.0943H0.413484C0.357453 9.09606 0.302312 9.10914 0.251211 9.13277C0.200111 9.15641 0.154054 9.19013 0.115673 9.23203C0.0772925 9.27393 0.0473406 9.32317 0.0275294 9.37694C0.00771825 9.43072 -0.00156357 9.48797 0.000214716 9.54542V10.4477C0.007252 10.5689 0.0571721 10.6834 0.140616 10.7696C0.224061 10.8558 0.335299 10.9078 0.453478 10.9159H4.5895L11.2551 17.7511C11.2808 17.7819 11.3002 17.8175 11.3124 17.8559C11.3246 17.8944 11.3293 17.9349 11.3262 17.9752C11.3231 18.0156 11.3123 18.0548 11.2944 18.0909C11.2765 18.1269 11.2518 18.1589 11.2218 18.1852C11.1736 18.2285 11.1125 18.2538 11.0485 18.2569H9.54873C9.4975 18.2537 9.44615 18.2609 9.39763 18.278C9.34911 18.2952 9.30437 18.322 9.26597 18.3569C9.22758 18.3918 9.19629 18.4342 9.17389 18.4816C9.15149 18.5289 9.13843 18.5803 9.13546 18.6329C9.13212 18.6486 9.13212 18.665 9.13546 18.6807V19.5317C9.14049 19.6469 9.18451 19.7566 9.25994 19.8421C9.33537 19.9275 9.43749 19.9834 9.54873 19.9999H14.2647C14.3667 20.0018 14.4655 19.963 14.5402 19.8915C14.6148 19.8201 14.6594 19.7217 14.6646 19.6172V14.6889C14.6673 14.636 14.6598 14.583 14.6425 14.533C14.6251 14.483 14.5984 14.437 14.5637 14.3976C14.529 14.3583 14.4871 14.3263 14.4404 14.3036C14.3936 14.2808 14.343 14.2678 14.2913 14.2652H13.3915C13.2885 14.2586 13.1873 14.2941 13.1098 14.3639C13.0324 14.4337 12.985 14.5322 12.9782 14.6377V16.2132C12.9778 16.2527 12.9697 16.2917 12.9546 16.328C12.9395 16.3644 12.9175 16.3973 12.8899 16.4249C12.8624 16.4525 12.8298 16.4743 12.7941 16.489C12.7583 16.5037 12.7201 16.511 12.6816 16.5105C12.6069 16.5086 12.5356 16.4781 12.4816 16.4251L7.02579 10.9159H16.1644C16.2202 10.9188 16.2741 10.9378 16.3198 10.9708C16.3655 11.0037 16.4013 11.0493 16.4228 11.1021C16.4444 11.155 16.451 11.213 16.4419 11.2696C16.4327 11.3261 16.4081 11.3789 16.371 11.4217L15.2978 12.4812C15.2174 12.5671 15.1725 12.6816 15.1725 12.8007C15.1725 12.9198 15.2174 13.0343 15.2978 13.1203L15.9177 13.7525C16.001 13.8348 16.1121 13.8808 16.2277 13.8808C16.3433 13.8808 16.4544 13.8348 16.5376 13.7525L19.8705 10.3622C19.9505 10.2785 19.9967 10.1667 19.9998 10.0495C20.0029 9.9322 19.9627 9.81807 19.8871 9.72997Z"
                                        fill="white" />
                                </svg>Filters
                            </button>
                        </template>
                    </div>

                    <template if:true={isShowModal}>
                        <div class="filter-div">
                            <div class="filter-fields">
                                <div class="filter-header">
                                    Filter Inquiries
                                </div>
                                <div class="scroll-div">
                                    <div class="slds-form_element">
                                        <lightning-combobox name="conditionType" label="Condition Type"
                                            value={selectedConditionType} options={conditionOptions}
                                            onchange={handleConditionTypeChange}>
                                        </lightning-combobox>
                                    </div>

                                    <template if:true={isCustomLogicSelected}>
                                        <div class="slds-form_element slds-m-top_medium">
                                            <label><span class="required-class">*</span>Logical Expression</label>
                                            <lightning-input variant="label-hidden" data-id="condition-input"
                                                value={logicalExpression} onchange={handleLogicalExpressionChange}
                                                placeholder="Enter logical expression">
                                            </lightning-input>
                                        </div>
                                    </template>

                                    <div class="slds-m-top_medium">
                                        <template if:false={mappings.length}>
                                            <p class="slds-text-align_center slds-text-color_weak slds-p-around_medium">
                                                No filters applied for this object.</p>
                                        </template>

                                        <template for:each={mappings} for:item="mapping">


                                            <div key={mapping.id} class="parent-div">
                                                <div class={mappingClass} onclick={handleMappingClick}
                                                    data-id={mapping.id} data-name="mapping-box">
                                                    <span class="mapping-id">{mapping.id}</span>

                                                    <div class="mapping-data">
                                                        {mapping.label} <br>
                                                        {mapping.displayOperator} " {mapping.valueField} "
                                                    </div>
                                                    <div class="delete-div" title="Delete" data-id={mapping.id}
                                                        onclick={handleDeleteMapping} data-name="delete">
                                                        <!-- <lightning-icon icon-name="utility:delete"  data-id={mapping.id} alternative-text="delete" size="small"></lightning-icon> -->
                                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                                            xmlns="http://www.w3.org/2000/svg" data-id={mapping.id}>
                                                            <path d="M3 6H5H21" stroke="#A30D11" stroke-width="2"
                                                                stroke-linecap="round" stroke-linejoin="round" />
                                                            <path
                                                                d="M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z"
                                                                stroke="#A30D11" stroke-width="2" stroke-linecap="round"
                                                                stroke-linejoin="round" />
                                                            <path d="M10 11V17" stroke="#A30D11" stroke-width="2"
                                                                stroke-linecap="round" stroke-linejoin="round" />
                                                            <path d="M14 11V17" stroke="#A30D11" stroke-width="2"
                                                                stroke-linecap="round" stroke-linejoin="round" />
                                                        </svg>

                                                        <span class="slds-assistive-text">Delete</span>
                                                    </div>
                                                </div>

                                            </div>
                                        </template>
                                    </div>
                                </div>

                            </div>
                            <div class="filter-footer">
                                <div class="add-condtion">
                                    <button class="btn modal-btn-blue" onclick={addCondition}
                                        disabled={isRealatedList}>Add Condition</button>
                                    <template if:true={isAddConditionModalVisible}>
                                        <div class="condition-div">
                                            <div class="filter-header">
                                                Configure Condition
                                            </div>
                                            <div class="condition-div-body">
                                                <div class="slds-form_element">
                                                    <lightning-combobox name="inquiryField" label="Inquiry Field"
                                                        value={inquiryFieldObject.MVEX__Field_Name__c}
                                                        options={inquirypicklistoptions}
                                                        onchange={handleInquiryFieldChange} required>
                                                    </lightning-combobox>
                                                </div>

                                                <div class="slds-form_element slds-m-top_medium">
                                                    <lightning-combobox name="conditionOperator" label="Condition"
                                                        value={selectedConditionOperator}
                                                        options={conditionOperatorOptions}
                                                        onchange={handleConditionOperatorChange} required>
                                                    </lightning-combobox>
                                                </div>

                                                <div class="slds-form_element slds-m-top_medium">
                                                    <lightning-input type="checkbox" label="Use Constant Value"
                                                        checked={isConstant} onchange={handleUseConstantChange}>
                                                    </lightning-input>
                                                </div>

                                                <template if:true={isConstant}>
                                                    <div class="slds-form_element slds-m-top_medium">
                                                        <label><span class="red">*</span>Value</label>
                                                        <template if:true={inquiryFieldObject.isPrimary}>
                                                            <lightning-input
                                                                type={inquiryFieldObject.MVEX__Data_Type__c}
                                                                value={selectedListingField} data-field="MVEX__Value__c"
                                                                onchange={handleListingFieldChange}
                                                                variant="label-hidden"></lightning-input>
                                                        </template>
                                                        <template if:true={inquiryFieldObject.isPicklist}>
                                                            <lightning-combobox value={selectedListingField}
                                                                data-field="MVEX__Value__c"
                                                                options={inquiryFieldObject.picklistValues}
                                                                onchange={handleListingFieldChange}
                                                                variant="label-hidden"></lightning-combobox>
                                                        </template>
                                                        <template if:true={inquiryFieldObject.isReference}>
                                                            <lightning-record-picker value={selectedListingField}
                                                                label="Reference" data-field="MVEX__Value__c"
                                                                object-api-name={inquiryFieldObject.objectApiName}
                                                                onchange={handleRefChange}
                                                                variant="label-hidden"></lightning-record-picker>
                                                        </template>
                                                    </div>
                                                </template>

                                                <template if:false={isConstant}>
                                                    <div class="slds-form_element slds-m-top_medium">
                                                        <lightning-combobox name="listingField" label="Listing Field"
                                                            value={selectedListingField} options={listingFieldOptions}
                                                            onchange={handleListingFieldChange} required>
                                                        </lightning-combobox>
                                                    </div>
                                                </template>
                                            </div>
                                            <div class="condition-div-footer">
                                                <button class="btn modal-btn-white"
                                                    onclick={closeAddConditionModal}>Cancel</button>
                                                <button class="btn modal-btn-blue" onclick={saveCondition}>Save</button>
                                            </div>
                                            <div class="arrow"></div>
                                        </div>
                                    </template>
                                </div>
                                <div class="custom__footer">
                                    <button class="btn modal-btn-white" onclick={hideModalBox}>Cancel</button>
                                    <button class="btn modal-btn-blue" onclick={applyModalFilters}>Apply</button>
                                </div>
                            </div>
                        </div>

                    </template>
                </div>
            </div>
        </div>

        <div class="slds-col slds-theme_default data-table-container">
            <template if:true={pagedInquries.length}>
                <table class="custom-data-table">
                    <thead>
                        <tr>
                            <th class="header-cell slds-text-align_right slds-cell_action-mode colume1" scope="col">
                                <span id="column-group-header" class="slds-assistive-text">Choose a row</span>
                                <div class="header-checkbox-div">
                                    <label class="custom-checkbox">
                                        <input type="checkbox" onchange={selectAllCheckbox} checked={checkAll}>
                                        <span class="checkmark"></span>
                                    </label>
                                </div>
                            </th>
                            <th class="header-cell slds-truncate">Inquiry Name</th>
                            <template for:each={tableColumns} for:item="column">
                                <th key={column.fieldName} class="header-cell slds-truncate">{column.label}</th>
                            </template>
                        </tr>
                    </thead>
                    <tbody>
                        <template for:each={pagedInquries} for:item="inquiry">
                            <tr key={inquiry.id}>
                                <td class="slds-text-align_right slds-cell_action-mode checkbox-cell" role="gridcell">
                                    <label class="custom-checkbox custom-checkbox-body">
                                        <input data-id={inquiry.id} type="checkbox" checked={inquiry.isSelected}
                                            value={inquiry.isSelected} onchange={checkBoxValueChange}>
                                        <span class="checkmark"></span>
                                    </label>
                                </td>
                                <td class="slds-truncate">
                                    <a href="javascript:void(0)" data-id={inquiry.id}
                                        onclick={navigateToRecord}>{inquiry.name}</a>
                                </td>
                                <template for:each={inquiry.displayFields} for:item="field">
                                    <td key={field.key} class="slds-truncate">
                                        <template if:true={field.hasValue}>
                                            <template if:true={field.isNameField}>
                                                <a href="javascript:void(0)" data-id={inquiry.id}
                                                    onclick={navigateToRecord}>{field.value}</a>
                                            </template>
                                            <template if:false={field.isNameField}>
                                                <template if:true={field.isCurrency}>
                                                    {inquiry.CurrencyIsoCode} {field.value}
                                                </template>
                                                <template if:false={field.isCurrency}>
                                                    {field.value}
                                                </template>
                                            </template>
                                        </template>
                                        <template if:false={field.hasValue}>
                                            <template if:true={field.isCurrency}>
                                                TBD
                                            </template>
                                        </template>
                                    </td>
                                </template>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </template>
            <template if:false={pagedInquries.length}>
                <div class="no-prop">
                    <img src={NoDataImageUrl} class="no-data-img" alt="No Data Found">
                    <p>No Inquiry found. Please change your search filters and try again.</p>
                </div>
            </template>
        </div>

        <template if:true={pagedInquries.length}>
            <div class="pagination-container slds-m-top_medium">
                <button class="pagination-button" disabled={isFirstPage} onclick={handlePrevious}>
                    <svg xmlns="http://www.w3.org/2000/svg" height="52" width="52" viewBox="0 0 520 520" fill="#fff">
                        <path
                            d="M342 477 134 272c-6-6-6-16 0-22L342 45c6-6 16-6 22 0l22 22c6 6 6 16 0 22L221 250c-6 6-6 16 0 22l163 161c6 6 6 16 0 22l-22 22c-5 5-14 5-20 0z" />
                    </svg>
                    Previous
                </button>

                <template for:each={pageNumbers} for:item="page">
                    <template if:false={page.isEllipsis}>
                        <button key={page.number} data-id={page.number} class={page.className}
                            onclick={handlePageChange}>
                            {page.number}
                        </button>
                    </template>
                    <template if:true={page.isEllipsis}>
                        <span key={page.number} class="pagination-ellipsis">...</span>
                    </template>
                </template>

                <button class="pagination-button" disabled={isLastPage} onclick={handleNext}>
                    Next
                    <svg xmlns="http://www.w3.org/2000/svg" height="52" width="52" viewBox="0 0 520 520" fill="#fff">
                        <path
                            d="m179 44 207 205c6 6 6 16 0 22L179 476c-6 6-16 6-22 0l-22-22c-6-6-6-16 0-22l163-161c6-6 6-16 0-22L136 88c-6-6-6-16 0-22l22-22c6-5 15-5 21 0z" />
                    </svg>
                </button>
            </div>
        </template>
    </div>

    <template if:true={isMassEmailModalOpen}>
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
            aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_small">
            <div class="slds-modal__container">
                <!-- Modal/Popup Header -->
                <div class="slds-modal__close closs_icon_css" onclick={closeModal}>
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M2.53317 19.3333L0.666504 17.4667L8.13317 9.99999L0.666504 2.53332L2.53317 0.666656L9.99984 8.13332L17.4665 0.666656L19.3332 2.53332L11.8665 9.99999L19.3332 17.4667L17.4665 19.3333L9.99984 11.8667L2.53317 19.3333Z"
                            fill="white" />
                    </svg>
                </div>

                <div class="slds-modal__header blue-header">
                    <h1 class="slds-modal__title slds-hyphenate" tabindex="-1">Send Email</h1>
                </div>

                <!-- Modal/Popup Body -->
                <div class="slds-modal__content slds-p-around_medium custom-modal-content">
                    <template if:true={isFirstScreen}>
                        <div class="total-records">
                            Total Inquiry Selected : {totalSelectedItems}
                        </div>

                        <div class="dotted-border"></div>

                        <div class="input-box">
                            <legend class="slds-form-element__legend slds-form-element__label"><span
                                    class="red">*</span>How do you want to send?</legend>
                            <lightning-combobox name="sendMethod" value={sendMethod} placeholder="Select a method"
                                options={messageOptions} onchange={handleSendMethodChange}>
                            </lightning-combobox>
                        </div>

                        <div class="input-box">
                            <legend class="slds-form-element__legend slds-form-element__label"><span
                                    class="red">*</span>Select Custom Template</legend>
                            <lightning-combobox name="gmailTemplate" value={selectedTemplate}
                                placeholder="Select a template" options={quickTemplates}
                                onchange={handletemplateChange}>
                            </lightning-combobox>
                        </div>


                        <div class="input-box" if:true={isForSingle}>
                            <legend class="slds-form-element__legend slds-form-element__label">Select Listing Template
                            </legend>
                            <lightning-combobox name="listingTemplate" value={selectedListingTemplate}
                                placeholder="Select a template" options={listingTemplateOptions}
                                onchange={handleListingTemplateChange}>
                            </lightning-combobox>
                        </div>
                    </template>

                    <template if:false={isFirstScreen}>
                        <div class="content-body">
                            <template if:true={isTemplateBody}>
                                <div class="template-body-header">
                                    <h3>Preview</h3>
                                </div>
                                <div class="dotted-border"></div>
                                <div class="scrollable-content">
                                    <div class="richText"></div>
                                </div>
                            </template>
                        </div>
                        <iframe lwc:if={vfGeneratePageSRC} class="generate_iframe" src={vfGeneratePageSRC} width="0%"
                            height="0%"></iframe>
                    </template>

                    <div class="footer-btns">
                        <template if:true={isFirstScreen}>
                            <button class="save_btn_css" onclick={handleFooterButtonClick}>Next</button>
                        </template>
                        <template if:false={isFirstScreen}>
                            <button class="cancel_btn_css" onclick={handleBack}>Back</button>
                            <button class="save_btn_css" onclick={handleFooterButtonClick}>Send</button>
                        </template>
                    </div>
                </div>

            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>

    </template>


    <template if:true={showTemplate}>
        <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-01"
            class="slds-modal slds-fade-in-open slds-modal_small">
            <div class="slds-modal__container send-template-modal-container">
                <div class="slds-modal__close closs_icon_css" onclick={handleCloseTemplate}>
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M2.53317 19.3333L0.666504 17.4667L8.13317 9.99999L0.666504 2.53332L2.53317 0.666656L9.99984 8.13332L17.4665 0.666656L19.3332 2.53332L11.8665 9.99999L19.3332 17.4667L17.4665 19.3333L9.99984 11.8667L2.53317 19.3333Z"
                            fill="white" />
                    </svg>
                </div>

                <div class="slds-modal__header blue-header">
                    <h1 class="slds-modal__title slds-hyphenate" tabindex="-1">{popupHeader}</h1>
                </div>

                <div class="modal-body">
                    <div class="custom-modal-body" id="modal-content-id-1">
                        <template if:true={popUpSecondPage}>
                            <div class="secondPage">
                                <div class="popUpBody">
                                    <div class="slds-grid slds-gutters slds-wrap slds-m-bottom_small inner-body-grid">
                                        <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                            <lightning-combobox name="template" label="Select Template"
                                                options={templateOptions} onchange={handleInputChange}
                                                value={selectedTemplate} required
                                                message-when-value-missing="Template is required"
                                                class="slds-m-bottom_medium">
                                            </lightning-combobox>
                                        </div>

                                        <div
                                            class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 right-section-preview">
                                            <template if:true={selectedTemplate}>
                                                <div class="preview-container">
                                                    <p class="slds-text-title_caps slds-m-bottom_small">Template Preview
                                                    </p>
                                                    <c-template-preview template-id={selectedTemplate}
                                                        record-id={previewRecordId} object-api-name={selectedObject}>
                                                    </c-template-preview>
                                                </div>
                                            </template>
                                            <template if:false={selectedTemplate}>
                                                <div class="slds-text-body_small slds-text-color_weak no-text slds-align_absolute-center"
                                                    style="height: 100%;">
                                                    Please select a template to preview.
                                                </div>
                                            </template>
                                        </div>
                                    </div>
                                </div>
                                <div class="popUpFooter slds-text-align--center">
                                    <lightning-button variant="brand" label="Send" onclick={handleSendOnPopup}
                                        class="slds-m-left_x-small"></lightning-button>
                                    <lightning-button variant="brand" label="Schedule" onclick={handleSchedulePopup}
                                        class="slds-m-left_x-small"></lightning-button>
                                </div>
                            </div>
                        </template>
                        <template if:true={popUpLastPage}>
                            <div class="lastPage">
                                <div
                                    class="slds-grid slds-grid_vertical-align-center slds-grid_align-center slds-m-around_medium">
                                    <lightning-input type="datetime-local" name="dateTime" value={selectedDateTime}
                                        onchange={handleInputChange} class="slds-align_absolute-center" required
                                        message-when-value-missing="Date and time are required"></lightning-input>
                                </div>
                                <div class="popUpFooter slds-text-align_center slds-p-bottom_large">
                                    <lightning-button variant="brand-outline" onclick={handlePreviousLastPage}
                                        label="Previous" class="slds-m-left_x-small"></lightning-button>
                                    <lightning-button variant="brand" label="Schedule and Send" onclick={handleSchedule}
                                        class="slds-m-left_x-small"></lightning-button>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>
</template>