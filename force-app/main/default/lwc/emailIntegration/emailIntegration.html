<template>
    <template if:true={isSpinner}>
        <c-spinner-component></c-spinner-component>
    </template>

    <template if:true={isDataLoaded}>
        <div class="smi_container">
            <div class="main_header_cls">
                <div class="sub_main_header_css">
                    <div slot="title" class="header_block_css">
                        <div class="svg_back_icon" onclick={backToControlCenter}>
                            <svg width="26" height="22" viewBox="0 0 30 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M28.3334 24.224C25.0711 20.2418 22.1742 17.9822 19.6427 17.4454C17.1111 16.9085 14.7009 16.8274 12.412 17.202V24.3334L1.66669 12.6967L12.412 1.66669V8.44469C16.6445 8.47802 20.2427 9.99646 23.2067 13C26.1702 16.0036 27.8791 19.7449 28.3334 24.224Z"
                                    fill="#131314" stroke="#131314" stroke-width="2" stroke-linejoin="round" />
                            </svg>
                        </div>
                        <div class="portal_mapping">
                            Email Integration
                        </div>
                    </div>
                    <div class="header">
                        <template if:true={isGmail}>
                            <template if:false={gmailData.isValid}>
                                <button class="save-btn" onclick={newIntegrationModal} data-name="Gmail">New</button>
                            </template>
                            <template if:true={gmailData.isValid}>
                                <button class="save-btn" onclick={newIntegrationModal} data-name="Gmail">Edit</button>
                                <button class="deactivate-btn" onclick={handleDeactivateClick}>Deactivate</button>
                            </template>
                        </template>

                        <template if:true={isOutlook}>
                            <template if:false={outlookData.isValid}>
                                <button class="save-btn" onclick={newIntegrationModal} data-name="Outlook">New</button>
                            </template>
                            <template if:true={outlookData.isValid}>
                                <button class="save-btn" onclick={newIntegrationModal} data-name="Outlook">Edit</button>
                                <button class="deactivate-btn" onclick={handleDeactivateClick}>Deactivate</button>
                            </template>
                        </template>
                    </div>
                </div>
            </div>
            <div class="main_container">
                <!-- Sidebar with navigator -->
                <div class="sidebar">
                    <ul>
                        <li class={gmailClass} onclick={handleGmailClick}>
                            <img src="/resource/MVEX__controlcenterimg/gmail.png" alt="insta" draggable="false"> Gmail
                        </li>
                        <li class={outlookClass} onclick={handleOutlookClick}>
                            <img src="/resource/MVEX__controlcenterimg/outlook.png" alt="outlook" draggable="false"> Outlook
                        </li>
                    </ul>
                </div>

                <!-- Main Content Area -->
                <div class="content">
                    <!-- Tab Specific Content -->
                    <div class="tab-content">
                        <template if:true={isGmail}>
                            <div class="field-section">
                                <template if:true={gmailData.isValid}>
                                    <div class="data_cls"><strong>Client Id :</strong><p>{displayedClientId}</p></div>
                                    <div class="data_cls">
                                        <strong>Client Secret :</strong>
                                        <p>{displayedClientSecret}</p>
                                    </div>
                                    <div class="data_cls"><strong>Redirect URI :</strong><p>{gmailData.integrationData.MVEX__Redirect_URI__c}</p></div>
                                    <div class="data_cls"><strong>Refresh Token :</strong><p>{displayedRefreshToken}</p></div>
                                    <div class="data_cls"><strong>Created Date:</strong><p>{gmailData.integrationData.CreatedDate}</p></div>
                                    <div class="data_cls"><strong>Last Modified Date:</strong><p>{gmailData.integrationData.LastModifiedDate}</p></div>
                                </template>
                                <template if:false={gmailData.isValid}>
                                    <div class="empty-state">
                                        <div class="empty-state__content">
                                            <div class="empty-state__icon">
                                                <img src="/resource/MVEX__emptyState" alt="" draggable="false">
                                            </div>
                                            <div class="empty-state__message">No Data Available to Show.</div>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </template>

                        <template if:true={isOutlook}>
                            <div class="field-section">
                                <template if:true={outlookData.isValid}>
                                    <div class="data_cls"><strong>Client Id :</strong><p>{displayedClientId}</p></div>
                                    <div class="data_cls">
                                        <strong>Client Secret :</strong>
                                        <p>{displayedClientSecret}</p>
                                    </div>
                                    <div class="data_cls"><strong>Redirect URI :</strong><p>{outlookData.integrationData.MVEX__Redirect_URI__c}</p></div>
                                    <div class="data_cls"><strong>Refresh Token :</strong><p>{displayedRefreshToken}</p></div>
                                    <div class="data_cls"><strong>Created Date:</strong><p>{outlookData.integrationData.CreatedDate}</p></div>
                                    <div class="data_cls"><strong>Last Modified Date:</strong><p>{outlookData.integrationData.LastModifiedDate}</p></div>
                                </template>
                                <template if:false={outlookData.isValid}>
                                    <div class="empty-state">
                                        <div class="empty-state__content">
                                            <div class="empty-state__icon">
                                                <img src="/resource/MVEX__emptyState" alt="" draggable="false">
                                            </div>
                                            <div class="empty-state__message">No Data Available to Show.</div>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </template>

                    </div>
                </div>
            </div>
        </div>
    </template>

    <template if:true={showIntegrationModal}>
        <c-integration-pop-up 
            integrationname={integrationName}
            integrationlabel={integrationLabel}
            onclosemodal={handleModalSelect}
        ></c-integration-pop-up>
    </template>

    <c-message-popup onconfirmation={handleConfirmation}>
    </c-message-popup>
</template>