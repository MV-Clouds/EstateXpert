<template>
    <template if:true={showSpinner}>
        <div class="overlay-spinner">
            <div class="upload-wrapper-spinner">
                <img src="/resource/MVEX__Animationimg" alt="Loading...">

                <div class="progress-section">
                    <div class="progress-bar">
                        <div class="progress-fill" style={progressStyle}></div>
                    </div>
                    <div class="progress-text saturationAnimation">{progressText}</div>
                </div>
            </div>
        </div>
    </template>

    <div class="container">
        <div class="main_header_cls">
            <div slot="title" class="header_block_css">
                <div class="svg_back_icon" onclick={backToControlCenter}>
                    <svg width="26" height="22" viewBox="0 0 30 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M28.3334 24.224C25.0711 20.2418 22.1742 17.9822 19.6427 17.4454C17.1111 16.9085 14.7009 16.8274 12.412 17.202V24.3334L1.66669 12.6967L12.412 1.66669V8.44469C16.6445 8.47802 20.2427 9.99646 23.2067 13C26.1702 16.0036 27.8791 19.7449 28.3334 24.224Z"
                            fill="#131314" stroke="#131314" stroke-width="2" stroke-linejoin="round" />
                    </svg>
                </div>
                <div>
                    Instagram Post Uploader
                </div>
            </div>
        </div>
        <template if:true={isIntegrated}>
            <div class="instagram-post-container">
                <div class="caption-input">
                    <div class="watermarkcss">
                        <div class="content_body">
                            <div class="tab-container">
                                <div class="tab-menu">
                                    <ul>
                                        <li onclick={tabing} data-name="AWS"><a class="active-tab"
                                                data-tab-id="tab1">Image
                                                Upload</a></li>
                                        <li onclick={tabing} data-name="Datalink"><a data-tab-id="tab2">Video Upload</a>
                                        </li>
                                    </ul>
                                </div>

                                <div class="tab active-tab-content" data-id="tab1" ondragover={allowDrop}
                                    ondrop={handleFileDrop}>
                                    <div class="fileuploader_container">
                                        <div class="slds-file-selector slds-file-selector_images">
                                            <div class="slds-file-selector__dropzone flex_css">
                                                <div>
                                                    <svg width="36" height="28" viewBox="0 0 36 28" fill="none"
                                                        xmlns="http://www.w3.org/2000/svg">
                                                        <path
                                                            d="M3.232 28C2.31067 28 1.542 27.692 0.926 27.076C0.31 26.46 0.00133333 25.6907 0 24.768V3.232C0 2.31067 0.308667 1.542 0.926 0.926C1.54333 0.31 2.31133 0.00133333 3.23 0H11.85C12.2807 0 12.6993 0.0866669 13.106 0.26C13.5127 0.436 13.8607 0.668667 14.15 0.958L17.192 4H32.77C33.69 4 34.4587 4.30867 35.076 4.926C35.6933 5.54333 36.0013 6.312 36 7.232V24.77C36 25.69 35.692 26.4587 35.076 27.076C34.46 27.6933 33.6913 28.0013 32.77 28H3.232ZM18 22.46C18.2853 22.46 18.5233 22.3653 18.714 22.176C18.9047 21.9867 19 21.7487 19 21.462V13.062L22.532 16.592C22.7187 16.7787 22.9473 16.8787 23.218 16.892C23.4887 16.9053 23.7313 16.8053 23.946 16.592C24.1607 16.3787 24.2673 16.1427 24.266 15.884C24.2647 15.6253 24.158 15.39 23.946 15.178L19.13 10.362C18.8073 10.0393 18.4307 9.878 18 9.878C17.5693 9.878 17.192 10.0393 16.868 10.362L12.132 15.1C11.944 15.2867 11.844 15.516 11.832 15.788C11.82 16.06 11.92 16.3027 12.132 16.516C12.344 16.7293 12.5793 16.836 12.838 16.836C13.0967 16.836 13.3327 16.7293 13.546 16.516L17 13.06V21.46C17 21.744 17.0953 21.982 17.286 22.174C17.4767 22.366 17.7147 22.4613 18 22.46Z"
                                                            fill="#0276D3" />
                                                    </svg>
                                                </div>
                                                <div class="formbold-drop-file images_upcss">
                                                    <p>Choose a image or drag & drop it here</p>
                                                    <p>OR</p>
                                                    <input type="file"
                                                        class="slds-file-selector__input slds-assistive-text"
                                                        onchange={handleSelectedFiles}
                                                        accept="image/png, image/jpeg, image/jpg, image/webp, image/avif"
                                                        id="file-upload-input-107" multiple
                                                        aria-labelledby="file-selector-primary-label-105 file-selector-secondary-label106" />
                                                    <label class="slds-file-selector__body" for="file-upload-input-107"
                                                        id="file-selector-secondary-label106">
                                                        <span class="formbold-browse">Browse File</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="tab" data-id="tab2" ondragover={allowDrop} ondrop={handleFileDrop}>
                                    <div class="fileuploader_container">
                                        <div class="slds-file-selector slds-file-selector_images">
                                            <div class="slds-file-selector__dropzone flex_css">
                                                <div>
                                                    <svg width="36" height="28" viewBox="0 0 36 28" fill="none"
                                                        xmlns="http://www.w3.org/2000/svg">
                                                        <path
                                                            d="M3.232 28C2.31067 28 1.542 27.692 0.926 27.076C0.31 26.46 0.00133333 25.6907 0 24.768V3.232C0 2.31067 0.308667 1.542 0.926 0.926C1.54333 0.31 2.31133 0.00133333 3.23 0H11.85C12.2807 0 12.6993 0.0866669 13.106 0.26C13.5127 0.436 13.8607 0.668667 14.15 0.958L17.192 4H32.77C33.69 4 34.4587 4.30867 35.076 4.926C35.6933 5.54333 36.0013 6.312 36 7.232V24.77C36 25.69 35.692 26.4587 35.076 27.076C34.46 27.6933 33.6913 28.0013 32.77 28H3.232ZM18 22.46C18.2853 22.46 18.5233 22.3653 18.714 22.176C18.9047 21.9867 19 21.7487 19 21.462V13.062L22.532 16.592C22.7187 16.7787 22.9473 16.8787 23.218 16.892C23.4887 16.9053 23.7313 16.8053 23.946 16.592C24.1607 16.3787 24.2673 16.1427 24.266 15.884C24.2647 15.6253 24.158 15.39 23.946 15.178L19.13 10.362C18.8073 10.0393 18.4307 9.878 18 9.878C17.5693 9.878 17.192 10.0393 16.868 10.362L12.132 15.1C11.944 15.2867 11.844 15.516 11.832 15.788C11.82 16.06 11.92 16.3027 12.132 16.516C12.344 16.7293 12.5793 16.836 12.838 16.836C13.0967 16.836 13.3327 16.7293 13.546 16.516L17 13.06V21.46C17 21.744 17.0953 21.982 17.286 22.174C17.4767 22.366 17.7147 22.4613 18 22.46Z"
                                                            fill="#0276D3" />
                                                    </svg>
                                                </div>
                                                <div class="formbold-drop-file images_upcss">
                                                    <p>Choose a video or drag & drop it here</p>
                                                    <p>OR</p>
                                                    <input type="file"
                                                        class="slds-file-selector__input slds-assistive-text"
                                                        onchange={handleVideoUpload} accept="video/mp4"
                                                        id="file-upload-input-108" multiple
                                                        aria-labelledby="file-selector-primary-label-105 file-selector-secondary-label106" />
                                                    <label class="slds-file-selector__body" for="file-upload-input-108"
                                                        id="file-selector-secondary-label107">
                                                        <span class="formbold-browse">Browse File</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="caption-input">
                    <label for="caption">Caption<span class="required-field">*</span></label>
                    <input type="text" data-id="caption" placeholder="Enter your Caption" maxlength="2200"
                        class="caption" value={caption} onchange={handleCaptionChange} />
                </div>
                <div class="submit-button">
                    <button onclick={handlePost} class="upload-button">Upload</button>
                    <template if:true={showPublishButton}>
                        <button onclick={handlePublish} class="upload-button publish-button">Publish to Instagram</button>
                    </template>
                </div>


                <div class="upload-section" ondragover={handleDragOver} ondrop={handleDrop}>

                    <div class="upload-wrapper">

                        <div class="upload-heading">
                            <h3>Uploaded Files</h3>
                        </div>

                        <div class="upload-data">

                            <template if:true={isFileAvailable}>
                                <div class="image-preview-container">
                                    <template for:each={selectedFilesToUpload} for:item="file" for:index="index">
                                        <div key={file.fileName} class="image-preview-item dropableimage"
                                            data-index={index} draggable="true" ondragstart={handleDragStart}
                                            ondragenter={handleDragEnter} ondragleave={handleDragLeave}
                                            ondragend={handleDragEnd}>
                                            <img src={file.previewUrl} alt={file.fileName} class="image-preview"
                                                draggable="true" data-index={index} />
                                            <div class="overlay">
                                                <div class="cancel-button" data-name={file.fileName}
                                                    onclick={handleRemoveFile}>âœ•</div>
                                                <div class="file-name">{file.fileName}</div>
                                            </div>
                                        </div>
                                    </template>
                                </div>
                            </template>

                            <template if:false={isFileAvailable}>

                                <div class="no-file-image">
                                    <img src={noUploadImagelink} alt="No Image Found">
                                </div>

                                <div class="no-file-image-data">

                                    <div class="upload-heading-1">
                                        No media files yet...
                                    </div>
                                    <div class="upload-heading-2">
                                        Please upload your images or video
                                    </div>
                                </div>

                            </template>

                        </div>
                    </div>
                </div>
            </div>
        </template>
        <template if:false={isIntegrated}>
            <div class="custom-card">
                <div class="content-wrapper">
                    <div class="icon-container">
                        <svg class="custom-icon" width="40" height="40" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve"
                            fill="#000000">
                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                            <g id="SVGRepo_iconCarrier">
                                <path style="fill:#464655;"
                                    d="M509.435,448.962L271.75,44.367c-7.076-12.045-24.424-12.045-31.5,0L2.565,448.962 c-7.194,12.245,1.595,27.705,15.75,27.705h475.368C507.839,476.666,516.629,461.207,509.435,448.962z">
                                </path>
                                <path style="fill:#5B5D6E;"
                                    d="M310.09,109.633c-75.525,54.5-124.731,143.208-124.731,243.46c0,44.069,9.578,85.877,26.64,123.573 h281.685c14.155,0,22.944-15.459,15.75-27.705L310.09,109.633z">
                                </path>
                                <path style="fill:#FFDC64;"
                                    d="M252.195,93.738L53.788,431.474c-2.57,4.374,0.585,9.885,5.658,9.885h393.11 c5.073,0,8.228-5.511,5.658-9.885L259.805,93.738C258.099,90.834,253.901,90.834,252.195,93.738z">
                                </path>
                                <path style="fill:#FFF082;"
                                    d="M185.36,353.093c0,30.722,4.638,60.357,13.216,88.267h253.98c5.073,0,8.228-5.511,5.658-9.885 L282.389,132.181C222.755,187.029,185.36,265.683,185.36,353.093z">
                                </path>
                                <g>
                                    <circle style="fill:#464655;" cx="256.028" cy="379.568" r="17.653"></circle>
                                    <path style="fill:#464655;"
                                        d="M239.049,213.171l7.566,113.485c0.33,4.948,4.174,8.784,8.805,8.784h1.216 c4.631,0,8.475-3.834,8.805-8.784l7.566-113.485c0.365-5.475-3.682-10.131-8.805-10.131h-16.347 C242.731,203.04,238.684,207.697,239.049,213.171z">
                                    </path>
                                </g>
                                <path style="fill:#FFC850;"
                                    d="M452.556,450.186H59.442c-5.499,0-10.62-2.966-13.353-7.741c-2.733-4.78-2.698-10.697,0.086-15.442 L244.587,89.258c2.405-4.086,6.672-6.525,11.422-6.525c4.741,0,9.008,2.439,11.413,6.525l198.401,337.744 c2.784,4.75,2.819,10.667,0.086,15.442C463.176,447.22,458.055,450.186,452.556,450.186z M63.399,432.533h385.201L255.998,104.684 L63.399,432.533z">
                                </path>
                                <path style="fill:#FFDC64;"
                                    d="M448.599,432.533H196.069c1.633,5.964,3.455,11.844,5.441,17.653h251.048 c5.499,0,10.62-2.966,13.353-7.741c2.733-4.775,2.698-10.692-0.086-15.442L289.135,126.224c-4.553,3.944-9,8.005-13.307,12.212 L448.599,432.533z">
                                </path>
                            </g>
                        </svg>
                    </div>
                    <div class="text-content">
                        <h2 class="custom-heading">Showcase Properties on Instagram</h2>
                        <p class="custom-text">Elevate your real estate listings by sharing stunning property photos
                            directly to Instagram. Connect your account to start posting today!</p>
                        <p class="custom-text">Set up your Instagram integration in the Social Media Settings page to
                            effortlessly promote your properties to a wider audience.</p>
                    </div>
                    <button class="custom-button" onclick={navigateToIntegrationPage}>Connect Instagram</button>
                </div>
            </div>
        </template>
    </div>

</template>