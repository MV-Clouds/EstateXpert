<template>
    <template if:true={isLoading}>
        <c-spinner-component></c-spinner-component>
    </template>
    <div class="mainDiv" id="modal-content-id-1">
        <div class="main-cover">
            <div class="header_container_css">
                <div class="header_title_css">
                    <div class="header-text-section">

                    </div>
                    <div class="header-action">
                        <button class="cancel_btn_css" aria-label="Cancel and close"
                            onclick={fetchMetadata}>Cancel</button>
                        <button class="save_btn_css" onclick={savecontactFieldsRecords}>Save</button>
                    </div>
                </div>
            </div>
            <div class="body-div">
                <div class="tableContainer">
                    <template if:true={isDataAvailable}>
                        <div class="popup__header-row">
                            <div class="slds-col display_css">
                                <p class="header-text">{fieldOwnerName}</p>
                            </div>
                            <div class="slds-col display_css">
                                <p class="header-text">Required</p>
                            </div>
                            <div class="slds-col display_css">
                                <p class="header-text">Order</p>
                            </div>
                            <div class="slds-col display_css">
                                <p class="header-text">Delete</p>
                            </div>
                        </div>
                        <div class="popup__recordValues">
                            <template for:each={contactFieldsItems} for:item="item" for:index="index">
                                <div key={item.id} class="popup__data-row">
                                    <div class="slds-col wrap_css">
                                        <div class="combobox-cover">
                                            <div class="combobox-input" data-index={index}
                                                data-id={index} onclick={handleFocus1}>
                                                <div class="input-show">
                                                    {item.label}
                                                </div>
                                                <div class="add-btn-class" data-index={index}
                                                    data-id={index} onclick={handleFocus1}>
                                                    <svg width="16" height="10" viewBox="0 0 16 10" fill="none"
                                                        xmlns="http://www.w3.org/2000/svg" data-index={index}
                                                        data-id={index} onclick={handleFocus1}>
                                                        <path d="M2 1.75L8 7.75L14 1.75" stroke="#131314"
                                                            stroke-width="2" stroke-linecap="square" />
                                                    </svg>
                                                </div>
                                                <template if:true={item.isFocused}>
                                                    <div class="options-box">
                                                        <input type="text"
                                                            class="slds-input slds-combobox__input picklist-input"
                                                            placeholder="Search Picklist Value" data-id={index}
                                                            data-index={index}
                                                            onkeyup={handleSearchChange} onfocus={handleFocus1}
                                                            onblur={handleBlur1} minlength="0" maxlength="25" />
                                                        <ul class="options-cover" onmousedown={handlePreventDefault}>
                                                            <template for:each={filteredFieldOptions} for:item="option1"
                                                                for:index="index1">
                                                                <li key={option1.value} data-index={index}
                                                                    data-label={option1.label}
                                                                    data-type={option1.fieldType}
                                                                    data-id={option1.value}
                                                                    onclick={selectOption1}
                                                                    class="options-value">
                                                                    <span class="slds-media__body">
                                                                        <span
                                                                            class="_entity">{option1.label}</span>
                                                                    </span>
                                                                </li>
                                                            </template>
                                                        </ul>
                                                    </div>
                                                </template>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="slds-col wrap_css order_btn_grp">
                                        <label class="custom-checkbox valuecsscls" data-valuecss={item.value} data-label={item.label}>
                                            <input type="checkbox" checked={item.isRequired} data-index={index}
                                                onchange={handleRequiredChange}>
                                            <span class="checkmark"></span>
                                        </label>
                                    </div>
                                    <div class="slds-col wrap_css">
                                        <div class="slds-button-group order_btn_grp" role="group">
                                            <div class="order_btn" aria-pressed="false" data-index={index}
                                                data-action="up" onclick={handleOrderChange}>
                                                <svg width="10" height="6" viewBox="0 0 10 6" fill="none"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path
                                                        d="M8.81667 6L5 2.2915L1.175 6L0 4.8583L5 -4.65616e-08L10 4.8583L8.81667 6Z"
                                                        fill="#0176D3" />
                                                </svg>
                                            </div>
                                            <div class="order_btn" aria-pressed="false" data-index={index}
                                                data-action="down" onclick={handleOrderChange}>
                                                <svg width="10" height="6" viewBox="0 0 10 6" fill="none"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path
                                                        d="M1.18333 8.21036e-08L5 3.7085L8.825 1.0942e-08L10 1.1417L5 6L0 1.1417L1.18333 8.21036e-08Z"
                                                        fill="#0176D3" />
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-col wrap_css order_btn_grp">
                                        <button class="delete-div valuecsscls" onclick={handleDelete} data-index={index} data-valuecss={item.value} data-label={item.label}>
                                            <svg width="14" height="14" viewBox="0 0 14 14" fill="none"
                                                xmlns="http://www.w3.org/2000/svg">
                                                <path
                                                    d="M2.62502 3.45834L3.32598 11.5194C3.40087 12.3807 4.12187 13.0417 4.98638 13.0417H9.01369C9.87819 13.0417 10.5992 12.3807 10.674 11.5194L11.375 3.45834M5.12502 3.25V2.625C5.12502 1.70453 5.87119 0.958336 6.79169 0.958336H7.20835C8.12885 0.958336 8.87502 1.70453 8.87502 2.625V3.25M1.16669 3.45834H12.8334"
                                                    stroke="#212529" stroke-width="1.25" stroke-linecap="round"
                                                    stroke-linejoin="round" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </template>

                        </div>
                    </template>
                    <template if:false={isDataAvailable}>
                        <div class="no-data-container">
                            <span>No Fields Are Selected. Please Add New Fields</span>
                        </div>
                    </template>
                </div>
                <div class="footerbtns">
                    <button class="add-new-btn" onclick={addNewRow}>
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M6.85714 9.14286H0V6.85714H6.85714V0H9.14286V6.85714H16V9.14286H9.14286V16H6.85714V9.14286Z"
                                fill="white" />
                        </svg>
                        Add Row
                    </button>
                </div>
            </div>
        </div>
    </div>
</template>